복습:lbp 중심보다 어두우면 0 밝으면 1

DeepFace 프레임워크
DeepFace는 다양한 검증된 모델들을 wrapping하고 있는 경량의 하이브리드 face recognition 프레임워크
딥러닝을 적용한 얼굴 검출 시스템의 처리 과정
얼굴 검출 -> 얼굴의 특징정 검출 (Face Alignment)후에 얼굴에 그리그 셀에 해당 정보의 정규화를 수행
Detection -> Alignments가 이루어진 데이터에 대해서 딥러닝을 학습 한다고 보면 됨 (다음은 얼굴 데이터 셋에서 많이 사용하는 안젤리나 졸리 예제)
DeepFace의 논문에는 이러한 alignment작업을 통해 약 1%의 정확도를 향상
하지만 OpenCV 나 dlimb 에서는 alignment를 해주는 기능이 없기 떄문에 직접 설정을 할 수 있어야 함
Face Alignment?
얼굴 특징점 검출(face landmark detection) 빙밥
눈, 코, 입 등의 얼굴 특징점 검출을 해주는 방법
2014년도에 나온 논문이 원천 기술임
일단 외국인들 기준으로 학습된 데이터들 셋이기 때문에 안젤리나 졸리사진두장을 준비

Representation 단계 (딥러닝 적용되는 단계)
얼굴 이미지를 CNN(Convolutional Neural Networks) 모델로 제공하지만 여기서의 작업은 분류(classification)가 아님
여기서 CNN 모델은 autoencoder와 유사한 임베딩(embedding)을 찾기 위해 사용
오토인코더는 비지도unsupervised 방식으로 훈련된 인공 신경망으로, 먼저 데이터에 인코딩 된 표현을 학습한 다음, 학습 된 인코딩 표현에서 입력 데이터를 (가능한한 가깝게) 생성하는 것을 목표로 한다. 따라서, 오토인코더의 출력은 입력에 대한 예측

동일인물로 이미지 쌍을 구분하기 위해 충분한 거리를 결정하기 위한 임계치
대략적오로 다음의 값을 가짐 (완전 동일한 이미지를 넣으면 값이 0이 나온다는 것을 보면)
두 이미지사이의 거리 < threshold 인 경우!

딥러닝을 사용한 접근을 한다면..? CNN 으로 얼굴을 추적후 LBPH 을 적용한 인식?
이 방법을 사용하는 것보다는.. 딥러닝을 적용한 Face 오픈 소스를 공부하고 적용하는 것이 훨씬 더 좋음 (정확도 측면에서!)  


얼굴 감정 인식
감정인식 연구의 주요 내용
사람의 감정을 분류하는 연구들 (주로 심리학쪽에서 진행) : 표현이 어려운 감정도 있음
사람의 얼굴표정, 음성등에서 감정을 데이터셋화하고 인식하는 연구 (AI 연구자들)
가상 인간이나 로봇에서 감정을 합성하고 표현하는 방법을 연구 (GPT AI 시대에서 필수적인 기술들..)

감정인식 프레임워크는 AI 기술들이 들어가는데 얼굴 표정만으로는 안되는 상황이 발생함 
따라서 얼굴 표정, 음성, 한국어까지 종합적으로 판단하고 해석하는 것이 필요

FER(Face Emotions Recognition)이라는 데이터셋을 사용
48x48 픽셀로 구성된 흑백 얼굴 이미지로 이루어진 데이터셋
7가지 감정을 표현한 얼굴들이죠(0=화남, 1=역겨움, 2=두려움, 3=행복함, 4=슬픔, 5=놀람, 6=평범함)
훈련 데이터는 28,709개이고, 테스트 데이터는 3,589개
예전에는 많이 쓰였지만 요즘은 덜함 그래도 제일 많이 썻던 데이터셋

FER(Face Emotions Recognition)이라는 데이터셋을 사용
48x48 픽셀로 구성된 흑백 얼굴 이미지로 이루어진 데이터셋
7가지 감정을 표현한 얼굴들이죠(0=화남, 1=역겨움, 2=두려움, 3=행복함, 4=슬픔, 5=놀람, 6=평범함)
훈련 데이터는 28,709개이고, 테스트 데이터는 3,589개
Fer2013 폴더 안에는 test 및 train 폴더가 있음

얼굴인식 응용 : 나이 인식
2015년 CVPR에 실린 “Age and Gender Classification using Convolutional Neural Networks” 논문의 저자가 공개한 코드를 바탕으로 구성 – 현재는 DeepFace 등 다양한 망들에서 폭넓게 구성되고 있음
 핵심 아이디어는 얼굴에서 연령때 별로 표혀되는 노화 정보들을 잘 분류하기 위해서 3단계의 컨볼루션 레이어를 가지고 각 레이어의 정보들이 학습에 사용(초창기라서 별다른 수식모델 고도화 없이 망 설계 테크닉으로 논문이 된 경우!)

지금 기준으로 보면 3단계의 망을 적절히 잘 쌓은 정도임

논문에서는 나이대를 8단계로 구분해둠, 성별도 판별 하도록 되어 있음
역시 얼굴 검출은 dlib 을 사용해서 한뒤 나이 구분만 수행
각 나이 및 성별에 따른 라벨링 데이터들을 로딩후, img 폴더에 있는 jpg 파일들을 glob를 통해서 임포트 함
